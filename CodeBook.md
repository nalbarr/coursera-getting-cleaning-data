# Coursera - Getting and Cleaning Data
# Week 4 - Project
## Student:  Narciso Albarracin

### CodeBook.md

#### Overview
The following steps were used to analyze and process the UCI Human Activity Recognition (HAR) data set.  Each step include sub steps that are described in more detail in technical sections as well as within analysis R script.

  1. Merge training and test data sets
  2. For each measurement, only extract only mean and standard deviation
  3. Name variables descriptively
  4. Label datset with descriptive names
  5. From #4, extract tidy data set representing average for each subject and each activity

The input data files at "UCI HAR Dataset" local sub directory are:

* ./features.txt
* ./features_info.txt
* ./activity_labels.txt
* ./train/X_train.txt
* ./train/y_train.txt
* ./train/subject_train.txt
* ./test/X_test.txt
* ./test/y_test.txt
* ./test/subject_test.txt

features.txt, features_info.txt and activity_labels.txt files are code description tables with numeric keys mapped to human readable descriptions.

Training versus test data are split between the training and test folders. File and table structures are identicial between training and test but varying in subjects and activities.  

Subject files include numeric identifiers for test subjects.  The y files are the (predicted) class as activity type (e.g., WALKING, etc.)  The x files are measurements observations stored as feature vectors across columns.

This project manipulates these data inputs as described inmajor steps.  We will load data from files into R, manipulate them and merge, join, select, and filter as necessary to get to a final data set.  The final data set represent tidy data principle and involves joining input file data, renaming columns to be descriptive and apply summary statistical functions such as mean on a limited set of measurement observations for individual mean and standard deviations.

What is an exammple of a relevant data manipulation?  For example, data streams were generated by an Android mobile device and have technical names that will be translated and mapped by run_analysis.R script. 

Although there are other sensor data available such as inertia data.  They are OUT OF SCOPE for this project.

#### Codes and data descriptions

The main entities to understand are subject, activity, and feature.  Subjects are divided into two experiments for training and testing.  Activity maps to Y values and Features map to X values.  The training and testing data sets have 7352 and 2947 observations resulting in a Y (predicted) class of any activity factors in WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, and LAYING using a 561 features.

Features are represented as a feature vector and stored column wise within a flat file table. Each feature or X measurement is named as <measurement>-<attributes>

For example, input data set describes a feature measurement as tBodyAcc-mean() and this can be inferred as "total body acceleration mean value)".

Other measurements can be fully described within UCI HAR directory in README.txt and feature_info.txt files.

##### Final output codes

The final tiday data set codes and data are:

 [1] "by.subject"                                  
 [2] "by.activity"                                 
 [3] "Mean-(timeBodyAccMagnitudeMean)"             
 [4] "Mean-(timeBodyAccMagnitudeStdDeviation)"     
 [5] "Mean-(timeGravityAccMagnitudeMean)"          
 [6] "Mean-(timeGravityAccMagnitudeStdDeviation)"  
 [7] "Mean-(timeBodyAccJerkMagnitudeMean)"         
 [8] "Mean-(timeBodyAccJerkMagnitudeStdDeviation)" 
 [9] "Mean-(timeBodyGyroMagnitudeMean)"            
[10] "Mean-(timeBodyGyroMagnitudeStdDeviation)"    
[11] "Mean-(timeBodyGyroJerkMagnitudeMean)"        
[12] "Mean-(timeBodyGyroJerkMagnitudeStdDeviation)"
[13] "Mean-(freqBodyAccMagnitudeMean)"             
[14] "Mean-(freqBodyAccMagnitudeStdDeviation)"     
[15] "Mean-(freqBodyAccJerkMagnitudeMean)"         
[16] "Mean-(freqBodyAccJerkMagnitudeStdDeviation)" 
[17] "Mean-(freqBodyGyroMagnitudeMean)"            
[18] "Mean-(freqBodyGyroMagnitudeStdDeviation)"    
[19] "Mean-(freqBodyGyroJerkMagnitudeMean)"        
[20] "Mean-(freqBodyGyroJerkMagnitudeStdDeviation)"

#### Technical Overview, Data Analysis and Processing

The following steps are additionally described within R processing script - run_analysis.R as inline comments.

##### 1. Merge training and test data sets
- 1a. Change working directory to process UCI HAR input data set files.
- 1b. Read files into data frames.
- 1c. Convert data frames into data tables
- 1d. Rename key columns to prepare for merge training and test data tables
- 1e. Create surrogate identity column for merging
- 1f. For training data, merge data tables based on identity column
- 1g. For test data, merge data tables based on identity column
- 1h. Append training and test data tables

##### 2. For each measurement, only extract only mean and standard deviation
- 2a. Set up new data data table for intermediate processing
- 2b. Map feature (descriptive) names to features ids
- 2c. Subset combined data table based on logical vector for required column names (e.g., variable means and standard deviations)

##### 3. Use descriptive activity names to name the activities in the data set
- 3a.  Set up new data data table for intermediate processing
- 3b.  Merge current data table with activities data table based on activity.id key

##### 4. Label data set with descriptive names
- 4a. Set up new data data table for intermediate processing
- 4b. Use regular expressions to match unfriendly names and replace them with friendly names.
- 4c. Rename data table columns

##### 5. From #4, extract tidy data set representing average for each subject and each activity
- 5a. Set up new data data table for intermediate processing
- 5b. Remove unncessary columns prior to computing mean (e.g., activity.name)
- 5c. Compute mean for each measurement by subject.id and activity.id
- 5d. Remove unnecessary columns (i.e., "subject.id", "activity.id")
- 5e. Export tidy data set

#### Example R snippets
The best way to describe this project's code, data and semantics is to see snippets of R script output during the 4 step process.  

"BEFORE - Step 1"" shows snippets of what data input file appear like when loaded into R data frames and data tables.  Finally, "AFTER - Step 4" shows a finalized tidy data table as dt4 prior to exporting and writing into final output file tidy_out.txt.

##### BEFORE (Step #1)
```
>list.dts$features
```

```
V1                                   V2
1:   1                    tBodyAcc-mean()-X
2:   2                    tBodyAcc-mean()-Y
3:   3                    tBodyAcc-mean()-Z
---
559: 559                 angle(X,gravityMean)
560: 560                 angle(Y,gravityMean)
561: 561                 angle(Z,gravityMean)
```
```
>list.dts$activities

V1                 V2
1:  1            WALKING
2:  2   WALKING_UPSTAIRS
3:  3 WALKING_DOWNSTAIRS
4:  4            SITTING
5:  5           STANDING
6:  6             LAYING
```
```
>list.dts$subjects.train
```
```
V1
1:  1
2:  1
3:  1
---
7350: 30
7351: 30
7352: 30
```

```
>list.dts$x.train
```
```
V1           V2          V3         V4          V5          V6         V7          V8
1: 0.2885845 -0.020294171 -0.13290514 -0.9952786 -0.98311061 -0.91352645 -0.9951121 -0.98318457
2: 0.2784188 -0.016410568 -0.12352019 -0.9982453 -0.97530022 -0.96032199 -0.9988072 -0.97491437
3: 0.2796531 -0.019467156 -0.11346169 -0.9953796 -0.96718701 -0.97894396 -0.9965199 -0.96366837
---
7350: 0.2733874 -0.017010616 -0.04502183 -0.2182182 -0.10382198  0.27453270 -0.3045152 -0.09891303
7351: 0.2896542 -0.018843044 -0.15828059 -0.2191394 -0.11141169  0.26889320 -0.3104875 -0.06820033
7352: 0.3515035 -0.012423118 -0.20386717 -0.2692704 -0.08721154  0.17740393 -0.3774040 -0.03867806
```

```
>list.dts$y.train
```

```
1:  5
2:  5
3:  5
---
7350:  2
7351:  2
7352:  2
```

##### AFTER (post step #4)

```
# Tidy data set output as data table.
# Note that by.subject and by.activity are grouping columns used by aggregate function to compute means.
> dt4
```

```
       activity.id timeBodyAccMagnitudeMean timeBodyAccMagnitudeStdDeviation
    1:           1              -0.22455962                       -0.2379807
    2:           1              -0.12650269                       -0.2133903
    3:           1              -0.16010001                       -0.2575711
    4:           1              -0.07351308                       -0.1951145
    5:           1              -0.04949205                       -0.2110254
   ---                                                                      
10295:           6              -0.98884319                       -0.9917777
10296:           6              -0.98174811                       -0.9873845
10297:           6              -0.98244389                       -0.9854095
10298:           6              -0.98609335                       -0.9902433
10299:           6              -0.98342545                       -0.9923642
       timeGravityAccMagnitudeMean timeGravityAccMagnitudeStdDeviation
    1:                 -0.22455962                          -0.2379807
    2:                 -0.12650269                          -0.2133903
    3:                 -0.16010001                          -0.2575711
    4:                 -0.07351308                          -0.1951145
    5:                 -0.04949205                          -0.2110254
   ---                                                                
10295:                 -0.98884319                          -0.9917777
10296:                 -0.98174811                          -0.9873845
10297:                 -0.98244389                          -0.9854095
10298:                 -0.98609335                          -0.9902433
10299:                 -0.98342545                          -0.9923642
       timeBodyAccJerkMagnitudeMean timeBodyAccJerkMagnitudeStdDeviation
    1:                   -0.2894243                           -0.1650001
    2:                   -0.1385012                           -0.1985903
    3:                   -0.1943548                           -0.2199436
    4:                   -0.1294801                           -0.1739346
    5:                   -0.1598686                           -0.1498507
   ---                                                                  
10295:                   -0.9902476                           -0.9920228
10296:                   -0.9867954                           -0.9905751
10297:                   -0.9880591                           -0.9916558
10298:                   -0.9910350                           -0.9934461
10299:                   -0.9886198                           -0.9909061
       timeBodyGyroMagnitudeMean timeBodyGyroMagnitudeStdDeviation timeBodyGyroJerkMagnitudeMean
    1:               -0.03439560                       -0.16818626                    -0.4661497
    2:               -0.14093823                       -0.21605518                    -0.3899198
    3:               -0.09459356                       -0.29084739                    -0.3741507
    4:               -0.04934062                       -0.09012390                    -0.2364741
    5:               -0.02141046                       -0.04463632                    -0.2200966
   ---                                                                                          
10295:               -0.98847990                       -0.98537004                    -0.9893181
10296:               -0.98444333                       -0.98240760                    -0.9848154
10297:               -0.98266539                       -0.98312491                    -0.9840703
10298:               -0.98276016                       -0.98127808                    -0.9873932
10299:               -0.97959682                       -0.97870913                    -0.9882131
       timeBodyGyroJerkMagnitudeStdDeviation freqBodyAccMagnitudeMean
    1:                            -0.4336540              -0.16681083
    2:                            -0.4389841              -0.07927762
    3:                            -0.4180319              -0.15631258
    4:                            -0.2294418              -0.10437689
    5:                            -0.2127722              -0.12319532
   ---                                                               
10295:                            -0.9884941              -0.99175364
10296:                            -0.9868671              -0.98726145
10297:                            -0.9889891              -0.98658361
10298:                            -0.9912512              -0.99075249
10299:                            -0.9885650              -0.99268415
       freqBodyAccMagnitudeStdDeviation freqBodyAccJerkMagnitudeMean
    1:                       -0.3995829                   -0.1540448
    2:                       -0.4230300                   -0.1784456
    3:                       -0.4368583                   -0.1494380
    4:                       -0.3762153                   -0.1322222
    5:                       -0.3878596                   -0.1160875
   ---                                                              
10295:                       -0.9920716                   -0.9909836
10296:                       -0.9883995                   -0.9891111
10297:                       -0.9858340                   -0.9905583
10298:                       -0.9903920                   -0.9936677
10299:                       -0.9923438                   -0.9904162
       freqBodyAccJerkMagnitudeStdDeviation freqBodyGyroMagnitudeMean
    1:                           -0.1846900              -0.222176040
    2:                           -0.2306563              -0.268279820
    3:                           -0.3212563              -0.308670720
    4:                           -0.2326118              -0.060131490
    5:                           -0.2010365              -0.003821466
   ---                                                               
10295:                           -0.9923899              -0.985383580
10296:                           -0.9914063              -0.981451300
10297:                           -0.9921421              -0.982940420
10298:                           -0.9915172              -0.983046410
10299:                           -0.9902372              -0.979559350
       freqBodyGyroMagnitudeStdDeviation freqBodyGyroJerkMagnitudeMean
    1:                        -0.2736495                    -0.4318317
    2:                        -0.3146234                    -0.4281859
    3:                        -0.4014002                    -0.4010383
    4:                        -0.2746461                    -0.2176688
    5:                        -0.2462486                    -0.1875509
   ---                                                                
10295:                        -0.9877505                    -0.9889995
10296:                        -0.9861809                    -0.9861487
10297:                        -0.9860755                    -0.9874496
10298:                        -0.9830186                    -0.9908205
10299:                        -0.9815917                    -0.9875887
       freqBodyGyroJerkMagnitudeStdDeviation subject.id activity.name
    1:                            -0.4763701          1       WALKING
    2:                            -0.4928844          1       WALKING
    3:                            -0.4819242          1       WALKING
    4:                            -0.2992263          1       WALKING
    5:                            -0.3003380          1       WALKING
   ---                                                               
10295:                            -0.9881846         24        LAYING
10296:                            -0.9884832         24        LAYING
10297:                            -0.9920103         24        LAYING
10298:                            -0.9921368         24        LAYING
10299:                            -0.9902872         24        LAYING
```
