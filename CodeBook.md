# Coursera - Getting and Cleaning Data
# Week 4 - Project
## Student:  Narciso Albarracin

### CodeBook.md

#### Overview
The following major steps were used to analyze and process the UCI Human Activity Recognition (HAR) data set.  Each step include sub steps that are described in detail.

* Merge training and test data sets
* For each measurement, only extract only mean and standard deviation
* Name variables descriptively
* Label datset with descriptive names
* From #4, extract tidy data set representing average for each subject and each activity

The input data files at "UCI HAR Dataset" local sub directory are:

* ./features.txt
* ./features_info.txt
* ./activity_labels.txt

* ./train/X_train.txt
* ./train/y_train.txt
* ./train/subject_train.txt

* ./test/X_test.txt
* ./test/y_test.txt
* ./test/subject_test.txt

features.txt, features_info.txt and activity_labels.txt files active as code description tables with a numeric key and human readable description.

Training versus test data is split between the training and test folders, but the file structures are similar for both sets of subject, X, y files.  The subject file include numeric identifiers for test subjects.  The y files are the (predicted) class as activity type (e.g., WALKING, etc.)  The x files are feature vectors with measurements stored across columns.

This project manipulates these input files in 4 major steps which will load data into R, load them into manipulation structures such as data frames and data tables and having to merge, join, select and filter for different purposes.

For example, data streams were generated by an Android mobile device and have technical names that will be translated and mapped by run_analysis.R script. 

Although there are other sensor data available such as inertia data.  They are OUT OF SCOPE for this project.

#### Codes and data descriptions

The main entities to understand are subject, activity, and feature.  Subjects are divided into two experiments for training and testing.  The training and testing data sets have 7352 and 2947 observations resulting in a Y (predicted) class of any activity factors in WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, and LAYING using a 561 features.

Features are represented as a feature vector and stored column wise within a flat file table. Each feature or X measurement is named as <measurement>-<attributes> (e.g., tBodyAcc-mean() can be inferred as total body acceleration mean value).  

Other measurement can be fully described within UCI HAR directory in README.txt and feature_info.txt files.

#### Technical Overview, Data Analysis and Processing

The following steps are additionally described within R processing script - run_analysis.R as inline comments.

##### 1. Merge training and test data sets
- 1a. Change working directory to process UCI HAR input data set files.
- 1b. Read files into data frames.
- 1c. Convert data frames into data tables
- 1d. Rename key columns to prepare for merge training and test data tables
- 1e. Create surrogate identity column for merging
- 1f. For training data, merge data tables based on identity column
- 1g. For test data, merge data tables based on identity column
- 1h. Append training and test data tables

##### 2. For each measurement, only extract only mean and standard deviation
- 2a. Set up new data data table for intermediate processing
- 2b. Map feature (descriptive) names to features ids
- 2c. Subset combined data table based on logical vector for required column names (e.g., variable means and standard deviations)

##### 3. Use descriptive activity names to name the activities in the data set
- 3a.  Set up new data data table for intermediate processing
- 3b.  Merge current data table with activities data table based on activity.id key

##### 4. Label data set with descriptive names
- 4a. Set up new data data table for intermediate processing
- 4b. Use regular expressions to match unfriendly names and replace them with friendly names.
- 4c. Rename data table columns

##### 5. From #4, extract tidy data set representing average for each subject and each activity
- 5a. Set up new data data table for intermediate processing
- 5b. Remove unncessary columns prior to computing mean (e.g., activity.name)
- 5c. Compute mean for each measurement by subject.id and activity.id
- 5d. Remove unnecessary columns (i.e., "subject.id", "activity.id")
- 5e. Export tidy data set

#### Example R snippets
The best way to describe this project's code, data and semantics is to see snippets of R script output during the 4 step process.  

"BEFORE - Step 1"" shows snippets of what data input file appear like when loaded into R data frames and data tables.  Finally, "AFTER - Step 4" shows a finalized tidy data table as dt4 prior to exporting and writing into final output file tidy_out.txt.

##### BEFORE (Step #1)
```
>list.dts$features
```

```
V1                                   V2
1:   1                    tBodyAcc-mean()-X
2:   2                    tBodyAcc-mean()-Y
3:   3                    tBodyAcc-mean()-Z
---
559: 559                 angle(X,gravityMean)
560: 560                 angle(Y,gravityMean)
561: 561                 angle(Z,gravityMean)
```
```
>list.dts$activities

V1                 V2
1:  1            WALKING
2:  2   WALKING_UPSTAIRS
3:  3 WALKING_DOWNSTAIRS
4:  4            SITTING
5:  5           STANDING
6:  6             LAYING
```
```
>list.dts$subjects.train
```
```
V1
1:  1
2:  1
3:  1
---
7350: 30
7351: 30
7352: 30
```

```
>list.dts$x.train
```
```
V1           V2          V3         V4          V5          V6         V7          V8
1: 0.2885845 -0.020294171 -0.13290514 -0.9952786 -0.98311061 -0.91352645 -0.9951121 -0.98318457
2: 0.2784188 -0.016410568 -0.12352019 -0.9982453 -0.97530022 -0.96032199 -0.9988072 -0.97491437
3: 0.2796531 -0.019467156 -0.11346169 -0.9953796 -0.96718701 -0.97894396 -0.9965199 -0.96366837
---
7350: 0.2733874 -0.017010616 -0.04502183 -0.2182182 -0.10382198  0.27453270 -0.3045152 -0.09891303
7351: 0.2896542 -0.018843044 -0.15828059 -0.2191394 -0.11141169  0.26889320 -0.3104875 -0.06820033
7352: 0.3515035 -0.012423118 -0.20386717 -0.2692704 -0.08721154  0.17740393 -0.3774040 -0.03867806
```

```
>list.dts$y.train
```

```
1:  5
2:  5
3:  5
---
7350:  2
7351:  2
7352:  2
```

##### AFTER (post step #4)

```
# tidy data set output as data table
> dt4
```

```
       activity.id timeBodyAccMagnitudeMean timeBodyAccMagnitudeStdDevation
    1:           1              -0.22455962                      -0.2379807
    2:           1              -0.12650269                      -0.2133903
    3:           1              -0.16010001                      -0.2575711
       timeGravityAccMagnitudeMean timeGravityAccMagnitudeStdDevation
    1:                 -0.22455962                         -0.2379807
    2:                 -0.12650269                         -0.2133903
    3:                 -0.16010001                         -0.2575711
       timeBodyAccJerkMagnitudeMean timeBodyAccJerkMagnitudeStdDevation
    1:                   -0.2894243                          -0.1650001
    2:                   -0.1385012                          -0.1985903
    3:                   -0.1943548                          -0.2199436
       timeBodyGyroMagnitudeMean timeBodyGyroMagnitudeStdDevation
    1:               -0.03439560                      -0.16818626
    2:               -0.14093823                      -0.21605518
    3:               -0.09459356                      -0.29084739
       timeBodyGyroJerkMagnitudeMean timeBodyGyroJerkMagnitudeStdDevation
    1:                    -0.4661497                           -0.4336540
    2:                    -0.3899198                           -0.4389841
    3:                    -0.3741507                           -0.4180319
       freqBodyAccMagnitudeMean freqBodyAccMagnitudeStdDevation
    1:              -0.16681083                      -0.3995829
    2:              -0.07927762                      -0.4230300
    3:              -0.15631258                      -0.4368583
       freqBodyAccJerkMagnitudeMean freqBodyAccJerkMagnitudeStdDevation
    1:                   -0.1540448                          -0.1846900
    2:                   -0.1784456                          -0.2306563
    3:                   -0.1494380                          -0.3212563
       freqBodyGyroMagnitudeMean freqBodyGyroMagnitudeStdDevation
    1:              -0.222176040                       -0.2736495
    2:              -0.268279820                       -0.3146234
    3:              -0.308670720                       -0.4014002
       freqBodyGyroJerkMagnitudeMean freqBodyGyroJerkMagnitudeStdDevation
    1:                    -0.4318317                           -0.4763701
    2:                    -0.4281859                           -0.4928844
    3:                    -0.4010383                           -0.4819242
       subject.id activity.name
    1:          1       WALKING
    2:          1       WALKING
    3:          1       WALKING
```
